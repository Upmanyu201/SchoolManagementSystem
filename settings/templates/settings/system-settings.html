{% extends 'base.html' %}
{% load static %}
{% load i18n %}

{% block title %}{% trans "System Settings" %} - {{ school_name|default:"School Management" }}{% endblock %}

{% block content %}
<div class="animate-fade-in">
    <!-- Header Card -->
    <div class="bg-white rounded-2xl shadow-xl p-6 mb-8 border border-blue-200">
        <div class="flex items-center justify-between">
            <div class="flex items-center">
                <div class="w-12 h-12 bg-gradient-to-r from-blue-500 to-indigo-600 rounded-xl flex items-center justify-center mr-4">
                    <i class="fas fa-cogs text-white text-xl"></i>
                </div>
                <div>
                    <h1 class="text-3xl font-bold bg-gradient-to-r from-blue-600 to-indigo-800 bg-clip-text text-transparent">
                        {% trans "System Settings" %}
                    </h1>
                    <p class="text-gray-600 mt-1">{% trans "Configure system preferences and language settings" %}</p>
                </div>
            </div>
            <a href="{% url 'dashboard' %}" 
               class="btn btn-secondary px-4 py-2 rounded-xl transition-all duration-300 hover:scale-105">
                <i class="fas fa-home mr-2"></i>{% trans "Dashboard" %}
            </a>
        </div>
    </div>

    <!-- Messages -->
    {% if messages %}
    <div id="form-messages" class="fixed top-4 right-4 z-50 space-y-2">
        {% for message in messages %}
        <div class="{% if message.tags == 'success' %}bg-green-500{% elif message.tags == 'error' %}bg-red-500{% else %}bg-blue-500{% endif %} text-white p-4 rounded-xl shadow-lg animate-slide-in">
            <div class="flex items-center">
                <i class="fas {% if message.tags == 'success' %}fa-check-circle{% elif message.tags == 'error' %}fa-exclamation-circle{% else %}fa-info-circle{% endif %} mr-3"></i>
                <span class="font-medium">{{ message }}</span>
            </div>
        </div>
        {% endfor %}
    </div>
    {% endif %}

    <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
        <!-- Language Settings Card -->
        <div class="bg-white rounded-2xl shadow-2xl overflow-hidden border border-gray-200">
            <div class="bg-gradient-to-r from-blue-500 to-indigo-600 p-6">
                <h2 class="text-white text-xl font-bold flex items-center">
                    <i class="fas fa-globe mr-3"></i>üåê {% trans "Language Settings" %}
                </h2>
            </div>
            <div class="p-8">
                <form method="POST" action="">
                    {% csrf_token %}
                    
                    <!-- Current Language Display -->
                    <div class="mb-6 p-4 bg-gradient-to-r from-blue-50 to-indigo-50 rounded-xl border border-blue-200">
                        <div class="flex items-center">
                            <div class="w-10 h-10 bg-gradient-to-r from-blue-500 to-indigo-600 rounded-full flex items-center justify-center mr-3">
                                <i class="fas fa-language text-white"></i>
                            </div>
                            <div>
                                <p class="text-sm text-gray-600">{% trans "Current Language" %}</p>
                                <p class="font-bold text-blue-800">
                                    {% if request.session.django_language == 'hi' %}
                                        üáÆüá≥ ‡§π‡§ø‡§®‡•ç‡§¶‡•Ä (Hindi)
                                    {% else %}
                                        üá∫üá∏ English
                                    {% endif %}
                                </p>
                            </div>
                        </div>
                    </div>

                    <!-- Language Selection -->
                    <div class="form-group mb-6">
                        <label class="block text-gray-700 font-semibold mb-3 flex items-center">
                            <i class="fas fa-flag mr-2 text-green-500"></i>{% trans "Select Language" %} / ‡§≠‡§æ‡§∑‡§æ ‡§ö‡•Å‡§®‡•á‡§Ç
                        </label>
                        <div class="space-y-3">
                            <!-- English Option -->
                            <label class="flex items-center p-4 border-2 border-gray-200 rounded-xl hover:border-blue-400 cursor-pointer transition-all duration-300 hover:bg-blue-50">
                                <input type="radio" name="language" value="en" 
                                       {% if request.session.django_language == 'en' or not request.session.django_language %}checked{% endif %}
                                       class="w-5 h-5 text-blue-600 mr-4">
                                <div class="flex items-center">
                                    <span class="text-2xl mr-3">üá∫üá∏</span>
                                    <div>
                                        <div class="font-bold text-gray-800">English</div>
                                        <div class="text-sm text-gray-500">Default system language</div>
                                    </div>
                                </div>
                            </label>

                            <!-- Hindi Option -->
                            <label class="flex items-center p-4 border-2 border-gray-200 rounded-xl hover:border-blue-400 cursor-pointer transition-all duration-300 hover:bg-blue-50">
                                <input type="radio" name="language" value="hi" 
                                       {% if request.session.django_language == 'hi' %}checked{% endif %}
                                       class="w-5 h-5 text-blue-600 mr-4">
                                <div class="flex items-center">
                                    <span class="text-2xl mr-3">üáÆüá≥</span>
                                    <div>
                                        <div class="font-bold text-gray-800">‡§π‡§ø‡§®‡•ç‡§¶‡•Ä (Hindi)</div>
                                        <div class="text-sm text-gray-500">‡§≠‡§æ‡§∞‡§§‡•Ä‡§Ø ‡§≠‡§æ‡§∑‡§æ ‡§∏‡§Æ‡§∞‡•ç‡§•‡§®</div>
                                    </div>
                                </div>
                            </label>
                        </div>
                    </div>

                    <!-- Regional Settings Preview -->
                    <div class="mb-6 p-4 bg-gradient-to-r from-gray-50 to-gray-100 rounded-xl border border-gray-200">
                        <h3 class="font-bold text-gray-800 mb-3 flex items-center">
                            <i class="fas fa-eye mr-2 text-purple-500"></i>{% trans "Format Preview" %} / ‡§™‡•ç‡§∞‡§æ‡§∞‡•Ç‡§™ ‡§™‡•Ç‡§∞‡•ç‡§µ‡§æ‡§µ‡§≤‡•ã‡§ï‡§®
                        </h3>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 text-sm">
                            <div>
                                <span class="text-gray-600">üìÖ {% trans "Date Format" %}:</span>
                                <span class="font-mono ml-2" id="datePreview">
                                    {% if request.session.django_language == 'hi' %}
                                        ‡•¶‡•ß/‡•¶‡•ß/‡•®‡•¶‡•®‡•™
                                    {% else %}
                                        01/01/2024
                                    {% endif %}
                                </span>
                            </div>
                            <div>
                                <span class="text-gray-600">{% trans "Currency" %}:</span>
                                <span class="font-mono ml-2" id="currencyPreview">
                                    {% if request.session.django_language == 'hi' %}
                                        ‚Çπ ‡•ß,‡•¶‡•¶‡•¶
                                    {% else %}
                                        ‚Çπ 1,000
                                    {% endif %}
                                </span>
                            </div>
                        </div>
                    </div>

                    <!-- Submit Button -->
                    <button type="submit" 
                            class="w-full bg-gradient-to-r from-blue-500 to-indigo-600 hover:from-blue-600 hover:to-indigo-700 text-white font-bold py-4 px-6 rounded-xl transition-all duration-300 transform hover:scale-105 shadow-lg">
                        <i class="fas fa-save mr-3"></i>
                        {% trans "Save Language Settings" %} / ‡§≠‡§æ‡§∑‡§æ ‡§∏‡•á‡§ü‡§ø‡§Ç‡§ó‡•ç‡§∏ ‡§∏‡§π‡•á‡§ú‡•á‡§Ç
                    </button>
                </form>
            </div>
        </div>

        <!-- System Information Card -->
        <div class="bg-white rounded-2xl shadow-2xl overflow-hidden border border-gray-200">
            <div class="bg-gradient-to-r from-green-500 to-emerald-600 p-6">
                <h2 class="text-white text-xl font-bold flex items-center">
                    <i class="fas fa-info-circle mr-3"></i>{% trans "System Information" %}
                </h2>
            </div>
            <div class="p-8 space-y-6">
                <!-- System Status -->
                <div class="p-4 bg-gradient-to-r from-green-50 to-emerald-50 rounded-xl border border-green-200">
                    <div class="flex items-center">
                        <div class="w-10 h-10 bg-gradient-to-r from-green-500 to-emerald-600 rounded-full flex items-center justify-center mr-3">
                            <i class="fas fa-check-circle text-white"></i>
                        </div>
                        <div>
                            <p class="font-bold text-green-800">{% trans "System Status" %}</p>
                            <p class="text-sm text-green-600">{% trans "All systems operational" %}</p>
                        </div>
                    </div>
                </div>

                <!-- Version Information -->
                <div class="space-y-3">
                    <div class="flex justify-between items-center p-3 bg-gray-50 rounded-lg">
                        <span class="text-gray-600 flex items-center">
                            <i class="fas fa-code-branch mr-2 text-blue-500"></i>{% trans "Version" %}
                        </span>
                        <span class="font-mono text-sm bg-blue-100 px-2 py-1 rounded">v2.1.0</span>
                    </div>
                    <div class="flex justify-between items-center p-3 bg-gray-50 rounded-lg">
                        <span class="text-gray-600 flex items-center">
                            <i class="fas fa-database mr-2 text-purple-500"></i>{% trans "Database" %}
                        </span>
                        <span class="font-mono text-sm bg-purple-100 px-2 py-1 rounded">SQLite</span>
                    </div>
                    <div class="flex justify-between items-center p-3 bg-gray-50 rounded-lg">
                        <span class="text-gray-600 flex items-center">
                            <i class="fas fa-server mr-2 text-orange-500"></i>{% trans "Server" %}
                        </span>
                        <span class="font-mono text-sm bg-orange-100 px-2 py-1 rounded">Django 4.2</span>
                    </div>
                </div>

                <!-- Quick Actions -->
                <div class="space-y-3">
                    <h3 class="font-bold text-gray-800 flex items-center">
                        <i class="fas fa-bolt mr-2 text-yellow-500"></i>‚ö° {% trans "Quick Actions" %}
                    </h3>
                    <div class="grid grid-cols-1 gap-3">
                        <button onclick="clearCache()" 
                                class="flex items-center justify-between p-3 bg-gradient-to-r from-yellow-50 to-orange-50 border border-yellow-200 rounded-lg hover:from-yellow-100 hover:to-orange-100 transition-all duration-300">
                            <span class="flex items-center">
                                <i class="fas fa-broom mr-2 text-yellow-600"></i>{% trans "Clear Cache" %}
                            </span>
                            <i class="fas fa-chevron-right text-yellow-600"></i>
                        </button>
                        <button onclick="checkUpdates()" 
                                class="flex items-center justify-between p-3 bg-gradient-to-r from-blue-50 to-indigo-50 border border-blue-200 rounded-lg hover:from-blue-100 hover:to-indigo-100 transition-all duration-300">
                            <span class="flex items-center">
                                <i class="fas fa-sync-alt mr-2 text-blue-600"></i>{% trans "Check Updates" %}
                            </span>
                            <i class="fas fa-chevron-right text-blue-600"></i>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Additional Settings Grid -->
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mt-8">
        <!-- Theme Settings -->
        <div class="bg-white rounded-xl shadow-lg p-6 border border-gray-200 hover:shadow-xl transition-all duration-300">
            <div class="flex items-center mb-4">
                <div class="w-10 h-10 bg-gradient-to-r from-purple-500 to-pink-600 rounded-lg flex items-center justify-center mr-3">
                    <i class="fas fa-palette text-white"></i>
                </div>
                <h3 class="font-bold text-gray-800">{% trans "Theme Settings" %}</h3>
            </div>
            <p class="text-gray-600 text-sm mb-4">{% trans "Customize visual appearance" %}</p>
            <button class="w-full bg-gradient-to-r from-purple-500 to-pink-600 hover:from-purple-600 hover:to-pink-700 text-white font-bold py-2 px-4 rounded-lg transition-all duration-300">
                <i class="fas fa-cog mr-2"></i>{% trans "Configure" %}
            </button>
        </div>

        <!-- Security Settings -->
        <div class="bg-white rounded-xl shadow-lg p-6 border border-gray-200 hover:shadow-xl transition-all duration-300">
            <div class="flex items-center mb-4">
                <div class="w-10 h-10 bg-gradient-to-r from-red-500 to-pink-600 rounded-lg flex items-center justify-center mr-3">
                    <i class="fas fa-shield-alt text-white"></i>
                </div>
                <h3 class="font-bold text-gray-800">{% trans "Security" %}</h3>
            </div>
            <p class="text-gray-600 text-sm mb-4">{% trans "Manage security policies" %}</p>
            <button class="w-full bg-gradient-to-r from-red-500 to-pink-600 hover:from-red-600 hover:to-pink-700 text-white font-bold py-2 px-4 rounded-lg transition-all duration-300">
                <i class="fas fa-lock mr-2"></i>{% trans "Configure" %}
            </button>
        </div>

        <!-- Backup Settings -->
        <div class="bg-white rounded-xl shadow-lg p-6 border border-gray-200 hover:shadow-xl transition-all duration-300">
            <div class="flex items-center mb-4">
                <div class="w-10 h-10 bg-gradient-to-r from-teal-500 to-cyan-600 rounded-lg flex items-center justify-center mr-3">
                    <i class="fas fa-cloud-upload-alt text-white"></i>
                </div>
                <h3 class="font-bold text-gray-800">{% trans "Backup" %}</h3>
            </div>
            <p class="text-gray-600 text-sm mb-4">{% trans "Data backup configuration" %}</p>
            <button class="w-full bg-gradient-to-r from-teal-500 to-cyan-600 hover:from-teal-600 hover:to-cyan-700 text-white font-bold py-2 px-4 rounded-lg transition-all duration-300">
                <i class="fas fa-download mr-2"></i>{% trans "Configure" %}
            </button>
        </div>
    </div>
</div>

<script>
// Auto-hide messages
document.addEventListener('DOMContentLoaded', function() {
    const messages = document.getElementById('form-messages');
    if (messages) {
        setTimeout(() => {
            messages.style.opacity = '0';
            messages.style.transform = 'translateX(100%)';
            setTimeout(() => messages.remove(), 500);
        }, 5000);
    }
    
    // Language selection preview update
    const languageInputs = document.querySelectorAll('input[name="language"]');
    languageInputs.forEach(input => {
        input.addEventListener('change', function() {
            updatePreview(this.value);
        });
    });
});

function updatePreview(language) {
    const datePreview = document.getElementById('datePreview');
    const currencyPreview = document.getElementById('currencyPreview');
    
    if (language === 'hi') {
        datePreview.textContent = '‡•¶‡•ß/‡•¶‡•ß/‡•®‡•¶‡•®‡•™';
        currencyPreview.textContent = '‚Çπ ‡•ß,‡•¶‡•¶‡•¶';
    } else {
        datePreview.textContent = '01/01/2024';
        currencyPreview.textContent = '‚Çπ 1,000';
    }
}

function clearCache() {
    // Show loading state
    const btn = event.target.closest('button');
    const originalContent = btn.innerHTML;
    btn.innerHTML = '<i class="fas fa-spinner fa-spin mr-2"></i>{% trans "Clearing..." %}';
    btn.disabled = true;
    
    // Simulate cache clearing
    setTimeout(() => {
        btn.innerHTML = '<i class="fas fa-check mr-2"></i>{% trans "Cache Cleared" %}';
        setTimeout(() => {
            btn.innerHTML = originalContent;
            btn.disabled = false;
        }, 2000);
    }, 1500);
}

function checkUpdates() {
    // Show loading state
    const btn = event.target.closest('button');
    const originalContent = btn.innerHTML;
    btn.innerHTML = '<i class="fas fa-spinner fa-spin mr-2"></i>{% trans "Checking..." %}';
    btn.disabled = true;
    
    // Simulate update check
    setTimeout(() => {
        btn.innerHTML = '<i class="fas fa-check mr-2"></i>{% trans "Up to Date" %}';
        setTimeout(() => {
            btn.innerHTML = originalContent;
            btn.disabled = false;
        }, 2000);
    }, 2000);
}
</script>

{% block extra_css %}
<style>
@keyframes slide-in {
    from {
        opacity: 0;
        transform: translateX(100%);
    }
    to {
        opacity: 1;
        transform: translateX(0);
    }
}

.animate-slide-in {
    animation: slide-in 0.3s ease-out;
}

.animate-fade-in {
    animation: fadeIn 0.8s ease-in-out;
}

@keyframes fadeIn {
    from { opacity: 0; transform: translateY(20px); }
    to { opacity: 1; transform: translateY(0); }
}

/* Radio button styling */
input[type="radio"]:checked {
    background-color: #3B82F6;
    border-color: #3B82F6;
}

/* Card hover effects */
.bg-white {
    transition: all 0.3s ease;
}

.bg-white:hover {
    transform: translateY(-2px);
}

/* Button animations */
button {
    transition: all 0.3s ease;
}

button:hover {
    transform: translateY(-1px);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
}

/* Language option hover effects */
label:hover {
    transform: translateX(4px);
}
</style>
{% endblock %}
{% endblock %}